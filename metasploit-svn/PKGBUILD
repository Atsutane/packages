# Maintainer: Thorsten TÃ¶pper <atsutane-aur@freethoughts.de>
# Contributor: Daniel Micay <danielmicay@gmail.com>
# Contributor: ryooichi <ryooichi+arch AT gmail DOT com>

pkgname=metasploit-svn
pkgver=16518MP
pkgrel=1
pkgdesc="The Metasploit Framework is a development platform for creating security tools and exploits."
arch=('any')
url='http://metasploit.com/'
license=('BSD')
depends=('ruby' 'ruby-msgpack')
makedepends=('subversion')
provides=('metasploit')
conflicts=('metasploit')
options=('!strip')

optdepends=('java-runtime: msfgui' 'ruby-pg: database support' 'glib-networking: msfgui')
if $_msfupdate; then
  optdepends+=('subversion: msfupdate')
fi

source=('svn+https://www.metasploit.com/svn/framework3/trunk')
md5sums=('SKIP')

_svnmod=metasploit

pkgver() {
  cd "$SRCDEST/trunk"
  svnversion
}

package() {
  cd "$pkgdir"
  mkdir -p usr/bin opt
  mv "$srcdir/trunk" opt/$_svnmod
  rm opt/$_svnmod/msfupdate

  install -Dm644 opt/$_svnmod/COPYING usr/share/licenses/$pkgname/COPYING

  cd usr/bin

  for f in ../../opt/metasploit/msf*; do
    ln -s $f .
  done
}

